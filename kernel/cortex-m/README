On interrupt, the state of registers is saved in the current task stack.


CORTEX-M1:

Before interrupt:              After interrupt:

        | ///////////// |               | ///////////// |
        |---------------|               |---------------|
   SP-> | ///////////// |      Old SP ->| ///////////// |
        |---------------|               |---------------|
        |               |               |     xPSR      |
        |---------------|               |---------------|
        |               |               |      PC       |
        |---------------|               |---------------|
        |               |               |      LR       |
        |---------------|               |---------------|
        |               |               |      R12      |
        |---------------|               |---------------|
        |               |               |      R3       |
        |---------------|               |---------------|
        |               |               |      R2       |
        |---------------|               |---------------|
        |               |               |      R1       |
                                        |---------------|
                                        |      R0       |
                                        |---------------|
                                        |      R7       |
                                        |---------------|
                                        |      R6       |
                                        |---------------|
                                        |      R5       |
                                        |---------------|
                                        |      R4       |
                                        |---------------|
                                        |     ISER0     |
                                        |---------------|
                                        |      R11      |
                                        |---------------|
                                        |      R10      |
                                        |---------------|
                                        |      R9       |
                                        |---------------|
                                        |      R8       |
                                        |---------------|
                               New SP ->|      LR       |
                                        |---------------|
                                        |               |

CORTEX-M3:

Before interrupt:              After interrupt:

        | ///////////// |               | ///////////// |
        |---------------|               |---------------|
   SP-> | ///////////// |      Old SP ->| ///////////// |
        |---------------|               |---------------|
        |               |               |     xPSR      |
        |---------------|               |---------------|
        |               |               |      PC       |
        |---------------|               |---------------|
        |               |               |      LR       |
        |---------------|               |---------------|
        |               |               |      R12      |
        |---------------|               |---------------|
        |               |               |      R3       |
        |---------------|               |---------------|
        |               |               |      R2       |
        |---------------|               |---------------|
        |               |               |      R1       |
                                        |---------------|
                                        |      R0       |
                                        |---------------|
                                        |    BASEPRI    |
                                        |---------------|
                                        |      R11      |
                                        |---------------|
                                        |      R10      |
                                        |---------------|
                                        |      R9       |
                                        |---------------|
                                        |      R8       |
                                        |---------------|
                                        |      R7       |
                                        |---------------|
                                        |      R6       |
                                        |---------------|
                                        |      R5       |
                                        |---------------|
                               New SP ->|      R4       |
                                        |---------------|
                                        |               |
